<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" class="dark-mode">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=11"/>
    <meta name="generator" content="Doxygen 1.9.6"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta property="og:title" content="MRAS: Developer Guide">
    <meta property="og:image" content="https://mras.sunride.space/sunride_logo.png">
    <meta property="og:description" content="Multi Rocket Avionics System">
    <meta name="theme-color" content="#EE3437">
    <title>MRAS: Developer Guide</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link rel="shortcut icon" href="sunride_rocket.ico" type="image/x-icon"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                <tr id="projectrow">
                    <td id="projectlogo"><img alt="Logo" src="sunride_logo.png"/></td>
                    <td id="projectalign">
                        <div id="projectname">MRAS
                        </div>
                        <div id="projectbrief">Multi Rocket Avionics System</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_developer_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Developer Guide </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This project is built with <a href="https://platformio.org/">PlatformIO</a>.</p>
<p>PlatformIO can be used with many different IDEs. See the following guide: <a href="https://platformio.org/install/integration">https://platformio.org/install/integration</a></p>
<p>We recommend that you use PlatformIO for VS Code or CLion. CLion is <em>strongly preferred</em> as it provides many code completion and analysis features that are not available in VS Code. However, the setup process of CLion is a bit cumbersome, and there is a steeper learning curve.</p>
<p>There are two objectives that you must achieve when setting up the project:</p><ul>
<li>Command line access to the <code>pio</code> command (installation of PIO core)</li>
<li>Integration of PlatformIO with your preferred IDE (such as CLion, VS Code, etc)</li>
</ul>
<blockquote class="doxtable">
<p>&zwj;Please note that we strongly recommend that you use CLion for this project. If you are a student, you can obtain a free license for CLion from JetBrains. <a href="https://www.jetbrains.com/community/education/#students">https://www.jetbrains.com/community/education/#students</a> </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md14"></a>
Installing PlatformIO</h1>
<p>The simplest installation method is as follows:</p>
<ol type="1">
<li>Install VS Code</li>
<li>Install the <a href="https://marketplace.visualstudio.com/items?itemName=platformio.platformio-ide">PlatformIO extension for VS Code</a></li>
</ol>
<p>In the background, this will install the PlatformIO core. This is the easiest way of getting it installed.</p>
<p>If this method doesn't work, or you want to install PlatformIO in a different way, refer to <a href="https://platformio.org/install/cli">this documentation</a></p>
<h1><a class="anchor" id="autotoc_md15"></a>
Adding pio to PATH</h1>
<p>Once you have installed PlatformIO, you need to add the PlatformIO <code>Scripts</code> folder to your PATH. This is so that you can use <code>pio</code> command from any terminal. Therefore, you will need to locate your platformio installation folder. In my case (Windows), it is located here: </p><pre class="fragment">C:\Users\tomto\.platformio\penv\Scripts
</pre> <h1><a class="anchor" id="autotoc_md16"></a>
Integrating PlatformIO with CLion</h1>
<p>Install the <a href="https://docs.platformio.org/en/latest/integration/ide/clion.html">PlatformIO plugin for CLion</a></p>
<p>Note that there are <em>many known issues</em> with the PlatformIO plugin for CLion, and you should refer to the linked page above regarding any issues. The setup process is quite detailed, please read the documentation carefully.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Opening the MRAS project in CLion</h1>
<ol type="1">
<li>Git clone the MRAS repository (<code>git clone <a href="https://github.com/TeamSunride/MRAS">https://github.com/TeamSunride/MRAS</a></code>)</li>
<li>Enter the MRAS directory (<code>cd MRAS</code>)</li>
<li>Init all submodules (<code>git submodule update --init --recursive</code>)</li>
<li>Open the MRAS project in CLion</li>
</ol>
<p>You will be greeted by this window. Close this window for now.</p>
<div class="image">
<img src="clion_open_new_project.png" alt=""/>
</div>
    <p>Make sure that the PlatformIO plugin is installed. You can check this by going to <code>File -&gt; Settings -&gt; Plugins</code>.</p>
<div class="image">
<img src="clion_start_error_dont_worry.png" alt=""/>
</div>
    <p>You may see this error. Ignore for now - it is fine.</p>
<p>Click <code>Tools -&gt; PlatformIO -&gt; Re-Init</code>. This will initialise PlatformIO for this project.</p>
<div class="image">
<img src="pio_reinit.png" alt=""/>
</div>
    <p>Click "edit configurations", configure a "PlatformIO Upload" configuration as shown and press "OK". Make sure to remove the "build" step before launch, as this is redundant. (See <a href="https://docs.platformio.org/en/latest/integration/ide/clion.html#build-upload">https://docs.platformio.org/en/latest/integration/ide/clion.html#build-upload</a>)</p>
<div class="image">
<img src="edit_configurations.png" alt=""/>
</div>
    <div class="image">
<img src="edit_configurations_2.png" alt=""/>
</div>
    <p>Go to <code>File -&gt; Settings -&gt; Build, Execution, Deployment -&gt; CMake</code>. Remove the default "Debug" profile and click the + button 3 times to create the <code>rocket</code>, <code>ground</code> and <code>native</code> profiles.</p>
<div class="image">
<img src="cmake_profiles.png" alt=""/>
</div>
    <p>Click "OK"</p>
<p>The project should now be set up. You can test that everything builds correctly by running <code>pio run</code> in the terminal. This will build the code for all configured environments (<code>rocket</code>, <code>ground</code> and <code>native</code>). You should see the following:</p>
<div class="image">
<img src="pio_run_success.png" alt=""/>
</div>
    <blockquote class="doxtable">
<p>&zwj;If you see an error here, it could be because you forgot to init all submodules after cloning the repository. Refer to the earlier steps to do this. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md18"></a>
Uploading code to the targets</h1>
<p>In order to list devices plugged into your computer, run <code>pio device list</code>. This will help you identify the correct COM port to use.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Uploading code to rocket environment</h2>
<pre class="fragment">pio run -e rocket -t upload -t monitor
</pre><p> If you have more than one device plugged into your computer, you will need to specify the COM port. For example: </p><pre class="fragment">pio run -e rocket -t upload -t monitor -p COM3
</pre> <h2><a class="anchor" id="autotoc_md20"></a>
Uploading code to ground environment</h2>
<pre class="fragment">pio run -e ground -t upload -t monitor
</pre> <h2><a class="anchor" id="autotoc_md21"></a>
Running code in native environment</h2>
<pre class="fragment">pio run -e native -t exec
</pre> <h1><a class="anchor" id="autotoc_md22"></a>
Project file structure</h1>
<p>Most source code is located in the <code>lib</code> folder. The <code>src</code> folder contains the main entry point for the project, and this is different for each environment. The <code>test</code> folder contains unit tests for the project.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
Code completion</h1>
<p>When writing code, make sure that the correct "resolve context" is being used for the current environment you are working in. See this menu at the bottom right of the screen:</p>
<div class="image">
<img src="resolve_context.png" alt=""/>
</div>
     </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
