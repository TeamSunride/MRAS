<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" class="dark-mode">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=11"/>
    <meta name="generator" content="Doxygen 1.9.6"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta property="og:title" content="MRAS: How to implement a new Subsystem">
    <meta property="og:image" content="https://mras.sunride.space/sunride_logo.png">
    <meta property="og:description" content="Multi Rocket Avionics System">
    <meta name="theme-color" content="#EE3437">
    <title>MRAS: How to implement a new Subsystem</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link rel="shortcut icon" href="sunride_rocket.ico" type="image/x-icon"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                <tr id="projectrow">
                    <td id="projectlogo"><img alt="Logo" src="sunride_logo.png"/></td>
                    <td id="projectalign">
                        <div id="projectname">MRAS
                        </div>
                        <div id="projectbrief">Multi Rocket Avionics System</div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_subsystem_implementation_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">How to implement a new <a class="el" href="classSubsystem.html">Subsystem</a> </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A <a class="el" href="classSubsystem.html">Subsystem</a> is a class in the MRAS system that represents a specific sensor or system on the device. These classes inherit from the base <a class="el" href="classSubsystem.html">Subsystem</a> class and implement its abstract methods. The <a class="el" href="classSubsystem.html">Subsystem</a> class provides a common interface for all sensors and systems, allowing for easy communication and management by the <a class="el" href="classMRAS__System.html" title="The main class of the MRAS system.">MRAS_System</a> class.</p>
<p>The <a class="el" href="classSubsystem.html">Subsystem</a> class has several members that are used to define the behavior and functionality of the sensor or system it represents. These include setup() and loop() methods, which are used to initialize and continuously update the sensor or system, respectively. Additionally, Subsystems have a get_status() method to check the current status of the <a class="el" href="classSubsystem.html">Subsystem</a>, self_test() method to check that the <a class="el" href="classSubsystem.html">Subsystem</a> is working correctly and on_message() method to handle messages sent to the <a class="el" href="classSubsystem.html">Subsystem</a>. The get_name() method returns a string that provides a human-readable name for the <a class="el" href="classSubsystem.html">Subsystem</a>, used for logging and debugging purposes. Finally, the get_id() method returns a unique ID assigned to the <a class="el" href="classSubsystem.html">Subsystem</a>, which is used to identify it within the MRAS system.</p>
<h1><a class="anchor" id="autotoc_md48"></a>
Step-by-step guide</h1>
<p>To implement a new subsystem for a new sensor, you can follow these steps:</p>
<ol type="1">
<li>Define a new class for your sensor subsystem, which should inherit from the <a class="el" href="classSubsystem.html">Subsystem</a> class. This class should be defined in its own header file, for example <code>Sensor_NewSensor.h</code></li>
<li>In the header file, define any variables or objects that your sensor subsystem will need to use, such as an instance of the sensor object.</li>
<li>Implement the <code>setup()</code> function in the class. This function should handle any one-time setup required for the sensor, such as initializing the sensor object and configuring it for use.</li>
<li>Implement the <code>loop()</code> function in the class. This function should handle the main functionality of your sensor subsystem, such as reading data from the sensor and publishing it to other subsystems.</li>
<li>Implement any additional functions or overrides that you want your sensor subsystem to have. For example, you may want to include a self-test function that verifies that the sensor is functioning properly.</li>
<li>In the main <code>setup()</code> function of the <a class="el" href="classMRAS__System.html" title="The main class of the MRAS system.">MRAS_System</a>, instantiate an object of your new sensor class, and add it as a subsystem to the <a class="el" href="classMRAS__System.html" title="The main class of the MRAS system.">MRAS_System</a> by calling <code>mras-&gt;add_subsystem(&amp;sensor);</code></li>
<li>If necessary, add the sensor class as a subscriber to other subsystems to allow for data transfer between them.</li>
</ol>
<h1><a class="anchor" id="autotoc_md49"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;Subsystem.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;NewSensor.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Sensor_NewSensor : <span class="keyword">public</span> <a class="code hl_class" href="classSubsystem.html">Subsystem</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    NewSensor* newSensor;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    Sensor_NewSensor(uint8_t <span class="keywordtype">id</span>, <span class="keywordtype">int</span> parameter1, <span class="keywordtype">int</span> parameter2, <span class="keywordtype">int</span> parameter3) : <a class="code hl_class" href="classSubsystem.html">Subsystem</a>(id) {</div>
<div class="line">        newSensor = <span class="keyword">new</span> NewSensor(parameter1, parameter2, parameter3);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ~Sensor_NewSensor() {</div>
<div class="line">        <span class="keyword">delete</span> newSensor;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    int8_t setup()<span class="keyword"> override </span>{</div>
<div class="line">        newSensor-&gt;begin();</div>
<div class="line">        newSensor-&gt;setDefaultConfig();</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    int8_t loop()<span class="keyword"> override </span>{</div>
<div class="line">        <span class="keywordtype">int</span> data = newSensor-&gt;readData();</div>
<div class="line">        <a class="code hl_function" href="classSubsystem.html#abab34124fc7777591cac49e0189a4291">publish</a>(data);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SUBSYSTEM_NAME(<span class="stringliteral">&quot;NewSensor&quot;</span>)</div>
<div class="line">};</div>
<div class="ttc" id="aclassSubsystem_html"><div class="ttname"><a href="classSubsystem.html">Subsystem</a></div><div class="ttdef"><b>Definition:</b> Subsystem.h:30</div></div>
<div class="ttc" id="aclassSubsystem_html_abab34124fc7777591cac49e0189a4291"><div class="ttname"><a href="classSubsystem.html#abab34124fc7777591cac49e0189a4291">Subsystem::publish</a></div><div class="ttdeci">void publish(SystemMessage *msg)</div><div class="ttdef"><b>Definition:</b> Subsystem.cpp:51</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
